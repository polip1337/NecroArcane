import{_ as v,L as M,I,c as u,o as d,b as a,k as y,a as x,m as E,e as h,w as k,d as L,F as p,r as g,O as S,Q as T,R as V,U as N,V as B,W as D,X as b,Y as F,s as U,G as A,g as G,h as R,t as m,n as q}from"./wizrobe.js";import{F as z}from"./filterbox.bundle.js";const H={mixins:[I],data(){return{filtered:null,sortBy:"name",sortOrder:1,fltLearn:!1,showLocked:!1}},components:{filterbox:z},beforeCreate(){this.game=A},methods:{formatNumber:M,fixIt(e){for(let s of e)s.encs=s.baseencs.slice()},searchIt(e,s){if(e.encs=e.baseencs.slice(),l(e.locale))return!0;for(let n=e.encs.length-1;n>=0;n--)l(e.encs[n])||e.encs.splice(n,1);if(e.encs.length>0)return!0;return e.encs=e.baseencs.slice(),!1;function l(n){if(n.name.toLowerCase().includes(s.toLowerCase()))return!0;if(n.tags){let o=n.tags;for(let t=o.length-1;t>=0;t--)if(o[t].toLowerCase().includes(s.toLowerCase()))return!0}if(n.mod)for(let o in n.mod){let t=game.state.getData(o);if(t!=null&&t.name.toLowerCase().includes(s.toLowerCase()))return!0}if(n.result)for(let o in n.result){let t=game.state.getData(o);if(t!=null&&t.name.toLowerCase().includes(s.toLowerCase()))return!0}if(n.loot&&n.tags.includes("loot_equip_gen")===!1)for(let o in n.loot){let t=game.state.getData(o);if(t!=null&&t.name.toLowerCase().includes(s.toLowerCase()))return!0}return!1}},allEncounters(){let e=this.game.state.encounters;var s=[];for(let n=e.length-1;n>=0;n--){var l=e[n];l.value<=0||s.push(l)}return s},allLocales(){let e=this.game.state.filterItems(n=>n.type===D||n.type===b||n.type===F).sort(U);var s=[];for(let n=e.length-1;n>=0;n--){var l=e[n];l.value<=0&&l.ex<=0||s.push(l)}return s},encByLocale(e,s){let l=[];if(!e.spawns.groups)return null;let n=e.spawns.groups.length;for(let o of e.spawns.groups){let t=this.game.getData(o.ids);if(!t){n--;continue}if(t.type!==B){n--;continue}s.findIndex(f=>f.id===t.id)!==-1&&s.splice(s.findIndex(f=>f.id===t.id),1),l.find(f=>f.id===t.id)?n--:t.value>0?(this.filter(t)&&l.push(t),n--):(t.locked||t.locks>0)&&n--}return{encs:l,unknown:n}},filter(e){return!(this.fltLearn&&!e.tags.includes("site_of_learning")||!this.showLocked&&this.locked(e))},hasMaxedMods(e){if(!e.mod||Object.keys(e.mod).length===0)return!1;for(let s in e.mod){let l=e.mod[s];if(!l.max)return!1;if(l instanceof S||(l=l.max),l instanceof T){if(!l.maxed())return!1}else if(l instanceof V){if(!l.maxed())return!1}else if(l instanceof N){if(!l.count)return!1}else return!1}return!0}},computed:{allItems(){var l;let e=this.allEncounters(),s=[];for(let n of this.allLocales()){let o={};o.locale=n;let t=this.encByLocale(n,e);if(t)o.encs=t.encs,o.baseencs=t.encs.slice(),o.unknown=t.unknown;else continue;(o.encs.length>0||this.fltLearn&&((l=o.locale.tags)!=null&&l.includes("site_of_learning")))&&s.push(o)}return s.length>0&&e.length>0&&s.push({locale:{id:"orphanedencs",name:"Encounters without locale"},encs:e,baseencs:e.slice(),unknown:0}),s},solTip(){return"Shows only Sites of Learning, encounters or adventures that will grant permanent positive modifiers."},lockTip(){return"Shows locked encounters that won't occur while adventuring."},clearTip(){return"Time spent per encounter."},hasLockedEncounter(){return this.allEncounters().some(this.locked)}}},c=e=>(G("data-v-04b00ee4"),e=e(),R(),e),Q={class:"search"},W=["id"],X=["for"],Y=["id"],J=["for"],K={class:"travelogue"},O=c(()=>a("span",{class:"header"},"Encounters",-1)),P=c(()=>a("span",{class:"header"},"Visits",-1)),Z=c(()=>a("span",{class:"header"},"Learned",-1)),j={class:"locale"},$=["onMouseenterCapture"],ee=["onMouseenterCapture"],se=c(()=>a("span",{class:"encounter"}," ?????? ",-1)),te=c(()=>a("span",null," ??? ",-1)),ne=c(()=>a("span",null," ??? ",-1)),le=c(()=>a("span",null," ??? ",-1)),oe=c(()=>a("hr",{style:{width:"95%","grid-column":"1/5"}},null,-1));function ae(e,s,l,n,o,t){const f=E("filterbox");return d(),u(p,null,[a("div",Q,[y(f,{modelValue:o.filtered,"onUpdate:modelValue":s[0]||(s[0]=r=>o.filtered=r),prop:t.searchIt,items:t.allItems,"min-items":5,defFunc:t.fixIt},null,8,["modelValue","prop","items","defFunc"]),a("span",{class:"chkSites",onMouseenterCapture:s[2]||(s[2]=h(r=>e.itemOver(r,null,null,null,t.solTip),["stop"]))},[k(a("input",{id:e.elmId("showSites"),type:"checkbox","onUpdate:modelValue":s[1]||(s[1]=r=>o.fltLearn=r)},null,8,W),[[L,o.fltLearn]]),a("label",{for:e.elmId("showSites")},"Sites of Learning",8,X)],32),t.hasLockedEncounter?(d(),u("span",{key:0,class:"chkSites",onMouseenterCapture:s[4]||(s[4]=h(r=>e.itemOver(r,null,null,null,t.lockTip),["stop"]))},[k(a("input",{id:e.elmId("showLocked"),type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=r=>o.showLocked=r)},null,8,Y),[[L,o.showLocked]]),a("label",{for:e.elmId("showLocked")},"Locked",8,J)],32)):x("",!0)]),a("div",K,[O,a("span",{class:"header",onMouseenterCapture:s[5]||(s[5]=h(r=>e.itemOver(r,null,null,null,t.clearTip),["stop"]))},"Clear Time",32),P,Z,(d(!0),u(p,null,g(o.filtered,r=>{var w;return d(),u(p,{key:r.locale.id},[a("div",j,[a("span",{onMouseenterCapture:h(i=>e.itemOver(i,r.locale),["stop"])},m(r.locale.name.toTitleCase()),41,$)]),a("span",null,m((w=r.locale.tags)!=null&&w.includes("site_of_learning")&&t.hasMaxedMods(r.locale)?"✓":""),1),(d(!0),u(p,null,g(r.encs,i=>{var _;return d(),u(p,{key:i.id},[a("span",{class:q(["encounter",e.locked(i)?"lock":""]),onMouseenterCapture:h(C=>e.itemOver(C,i),["stop"])},m(i.name.toTitleCase()),43,ee),a("span",null,m(t.formatNumber(i.length/i.rate.value,1,!1)+"s"),1),a("span",null,m(Math.floor(i.value)),1),a("span",null,m((_=i.tags)!=null&&_.includes("site_of_learning")&&t.hasMaxedMods(i)?"✓":""),1)],64)}),128)),(d(!0),u(p,null,g(r.unknown,i=>(d(),u(p,null,[se,te,ne,le],64))),256)),oe],64)}),128))])],64)}const ue=v(H,[["render",ae],["__scopeId","data-v-04b00ee4"]]);export{ue as default};
