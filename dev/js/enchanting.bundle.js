import{_ as y,c,o as d,b as s,t as l,F as g,r as b,e as v,I as T,k as p,m as f,a as S,l as w,a7 as I,G as _,a8 as M,g as V,h as A,w as K,d as N}from"./wizrobe.js";import{F as B}from"./filterbox.bundle.js";import E from"./inventory.bundle.js";const O={props:["eslots","inv"],computed:{},methods:{canTake(e){return e.target&&this.inv.canAdd(e.target)},onTake(e){this.inv.canAdd(e.target)&&(this.inv.add(e.target),this.eslots.remove(e))}}},U={class:"enchant-slots"},D={class:"enchant-desc"},F=["onMouseenterCapture"],L=["onMouseenterCapture"],x=["disabled","onClick"];function G(e,t,a,u,o,r){return d(),c("div",U,[s("span",null,l(Math.floor(a.eslots.used))+" / "+l(Math.floor(a.eslots.max))+" Enchanting Power used. ",1),(d(!0),c(g,null,b(a.eslots.items,i=>(d(),c("div",{class:"enchant-slot",key:i.id},[s("span",D,[s("span",null,"Level "+l(i.item.level),1),s("span",{class:"item-name",onMouseenterCapture:v(m=>e.itemOver(m,i.target),["stop"])},l(i.target.name.toTitleCase()),41,F),s("span",{class:"enchant-name",onMouseenterCapture:v(m=>e.itemOver(m,i.item),["stop"])},l(i.item.name.toTitleCase()),41,L)]),s("span",null,l(i.percent()+"%"),1),s("button",{type:"button",class:"btn-take",disabled:!r.canTake(i),onClick:m=>r.onTake(i)},l(i.done?"take":"cancel"),9,x)]))),128))])}const P=y(O,[["render",G],["__scopeId","data-v-d1a65bca"]]),H={mixins:[T],components:{eslots:P,filterbox:B,inv:E},data(){return{filtered:null,target:null,viewKinds:[]}},beforeCreate(){this.game=_,this.state=_.state,this.runner=this.state.runner,this.inv=this.state.getData("inventory"),this.enchantSlots=this.state.getData(M)},methods:{begin(e,t){this.emit("enchant",e,t),this.inv.remove(t),this.target=null},clearTarget(){this.target=null},resume(){_.toggleTask(this.enchantSlots)},canSee(e,t){return!t||!e.only||I(e.only,t)},canUse(e,t){return e.canUse()&&this.enchantSlots.canAdd(e)&&(!t||e.canAlter(t))}},computed:{allKinds(){const e=[];for(const t of this.enchants){const a=t.only;if(Array.isArray(a))for(const u of a)e.includes(u)||e.push(u);else a&&!e.includes(a)&&e.push(a)}return e},enchants(){return this.state.enchants.filter(e=>!this.locked(e))},showItems(){},onlyKinds(){const e=this.enchants,t=this.viewKinds;return t.length>0?e.filter(a=>{const u=a.only;if(Array.isArray(u))return t.some(o=>u.includes(o));if(typeof u=="string"&&t.includes(u))return!0}):e},visible(){const e=this.target;return e?this.filtered.filter(t=>this.canSee(t,e)):this.filtered}}},R=e=>(V("data-v-434476da"),e=e(),A(),e),X={class:"enchants"},j={class:"separate"},q=R(()=>s("div",{class:"note-text"},"Enchantment levels on an Item cannot exceed Item's enchant slots.",-1)),z=["disabled"],J={class:"checkboxes"},Q=["value","id"],W=["for"],Y={class:"separate"},Z={class:"filters"},$={key:0},ee={class:"enchant-list"},te=["onMouseenterCapture"],ne={class:"ench-name"},se=["disabled","onClick"],oe=["onClick","disabled"];function ae(e,t,a,u,o,r){const i=f("eslots"),m=f("filterbox"),k=f("inv");return d(),c("div",X,[s("div",j,[s("div",null,[s("div",{onMouseenterCapture:t[0]||(t[0]=v(n=>e.itemOver(n,o.target),["stop"]))}," Target: "+l(o.target?o.target.name.toTitleCase():"None"),33),q]),s("span",null,[s("button",{type:"button",disabled:e.enchantSlots.count==0,onClick:t[1]||(t[1]=(...n)=>r.resume&&r.resume(...n))},l(e.runner.has(e.enchantSlots)?"Pause":"Resume"),9,z)])]),p(i,{class:"eslots",eslots:e.enchantSlots,inv:e.inv},null,8,["eslots","inv"]),s("div",J,[(d(!0),c(g,null,b(r.allKinds,(n,h)=>(d(),c("div",{class:"category",key:h},[K(s("input",{type:"checkbox",value:n,id:e.elmId("chk"+h),"onUpdate:modelValue":t[2]||(t[2]=C=>o.viewKinds=C)},null,8,Q),[[N,o.viewKinds]]),s("label",{for:e.elmId("chk"+h)},l(n.replace("t_","")),9,W)]))),128))]),s("div",Y,[s("div",Z,[o.target?(d(),c("div",$,[s("button",{type:"button",class:"stop",onClick:t[3]||(t[3]=(...n)=>r.clearTarget&&r.clearTarget(...n))},"X"),w(l(o.target.name.toTitleCase()),1)])):S("",!0),p(m,{modelValue:o.filtered,"onUpdate:modelValue":t[4]||(t[4]=n=>o.filtered=n),items:r.onlyKinds},null,8,["modelValue","items"]),s("div",ee,[(d(!0),c(g,null,b(r.visible,n=>(d(),c("div",{class:"enchant",key:n.id,onMouseenterCapture:v(h=>e.itemOver(h,n),["stop"])},[s("span",ne,l(n.name.toTitleCase()),1),n.buy&&!n.owned?(d(),c("button",{key:0,type:"button",disabled:!n.canBuy(e.game),onClick:h=>e.emit("buy",n)}," ðŸ”’ ",8,se)):(d(),c("button",{key:1,type:"button",onClick:h=>r.begin(n,o.target),disabled:!this.canUse(n,o.target)}," Enchant ",8,oe))],40,te))),128))])]),p(k,{selecting:!0,inv:e.state.inventory,modelValue:o.target,"onUpdate:modelValue":t[5]||(t[5]=n=>o.target=n),types:["armor","weapon"],kinds:o.viewKinds,"hide-space":"true"},null,8,["inv","modelValue","kinds"])])])}const ce=y(H,[["render",ae],["__scopeId","data-v-434476da"]]);export{ce as default};
