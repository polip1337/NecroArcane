import{_ as b,G as d,a7 as p,a9 as C,c as l,o as i,b as m,a as r,u as _,m as g,t as f,F as v,r as M,n as E,e as h}from"./wizrobe.js";import{F as S}from"./filterbox.bundle.js";const U={props:["modelValue","inv","take","selecting","nosearch","types","kinds","combat"],emits:["update:modelValue"],data(){return{filtered:null,cols:1}},created(){this.USE=C;const e=window.getComputedStyle(document.documentElement),s=parseFloat(e.fontSize);this.cellWidth=s*12},mounted(){window.addEventListener("resize",this.resize),this.resize()},unmounted(){window.removeEventListener("resize",this.resize)},components:{filterbox:S},methods:{resize(){const e=this.$refs.gridRef;e?this.cols=Math.floor(e.clientWidth/this.cellWidth):this.cols=1},sellAll(){const e=this.filtered;for(let s=e.length-1;s>=0;s--)this.emit("sell",e[s],this.inv,e[s].count)},count(e){return e>1?" ("+Math.floor(e)+")":""},drop(e){this.inv.remove(e)},canAdd(e){return d.state.inventory.canAdd(e)},canEquip(e){return d.canEquip(e)},canUse(e){return d.canUse(e)},onTake(e){this.emit("take",e),this.inv.remove(e)},onselect(e){this.$emit("update:modelValue",e)},searchIt(e,s){const n=new RegExp(s,"i");if(n.test(e.name)||n.test(e.slot))return!0;if(e.tags){let c=e.tags;for(let u=c.length-1;u>=0;u--)if(n.test(c[u]))return!0}if(e.mod&&typeof e.mod=="object"){for(let c in e.mod)if(game.state.getData(c)&&typeof game.state.getData(c)=="object"&&n.test(game.state.getData(c).name))return!0}return!1}},computed:{baseItems(){const e=this.types,s=e?this.inv.items.filter(n=>e.includes(n.type)):this.inv.items;return this.kinds&&this.kinds.length>0?s.filter(n=>p(this.kinds,n)):s},playerInv(){return this.inv===d.state.inventory},playerFull(){return d.state.inventory.full()}}},w={class:"inventory"},z={class:"top"},F={key:1},A={key:0},I={class:"item-table",ref:"gridRef"},V=["onMouseenterCapture"],q={class:"item-buttons"},B=["onClick"],O=["disabled","onMouseenterCapture","onClick"],D=["onClick"],T=["disabled","onMouseenterCapture","onClick"],L=["onClick"],R=["onClick","onMouseenterCapture"],W=["onClick","onMouseenterCapture"],j={key:0,class:"warn-text"};function G(e,s,n,c,u,a){const k=g("filterbox");return i(),l("div",w,[m("span",z,[n.nosearch?r("",!0):(i(),_(k,{key:0,ref:"filter",modelValue:u.filtered,"onUpdate:modelValue":s[0]||(s[0]=t=>u.filtered=t),prop:a.searchIt,items:a.baseItems},null,8,["modelValue","prop","items"])),!n.selecting&&!n.combat?(i(),l("span",F,[n.inv.max>0?(i(),l("span",A,f(n.inv.items.length+" / "+Math.floor(n.inv.max.value)+" Used"),1)):r("",!0),n.inv.count>0?(i(),l("button",{key:1,type:"button",onClick:s[1]||(s[1]=(...t)=>a.sellAll&&a.sellAll(...t))},"Sell All")):r("",!0)])):r("",!0)]),m("div",I,[(i(!0),l(v,null,M(n.nosearch?a.baseItems:u.filtered,(t,y)=>(i(),l("div",{class:E([y%(2*u.cols)<u.cols?"off-color":"","item separate"]),key:t.id},[m("span",{class:"item-name",onMouseenterCapture:h(o=>e.itemOver(o,t),["stop"])},f(t.name+a.count(t.count)),41,V),m("div",q,[n.selecting?(i(),l("button",{key:0,type:"button",class:"item-action",onClick:o=>a.onselect(t)},"Select",8,B)):n.combat?(i(),l(v,{key:1},[t.use?(i(),l("button",{key:0,type:"button",disabled:!a.canUse(t),class:"item-action",onMouseenterCapture:h(o=>e.itemOver(o,t),["stop"]),onClick:o=>e.emit(e.USE,t,n.inv)}," Use ",40,O)):r("",!0)],64)):(i(),l(v,{key:2},[t.equippable&&a.canEquip(t)?(i(),l("button",{key:0,type:"button",class:"item-action",onClick:o=>e.emit("equip",t,n.inv)}," Equip ",8,D)):r("",!0),t.use?(i(),l("button",{key:1,type:"button",disabled:!a.canUse(t),class:"item-action",onMouseenterCapture:h(o=>e.itemOver(o,t),["stop"]),onClick:o=>e.emit(e.USE,t,n.inv)}," Use ",40,T)):r("",!0),n.take&&a.canAdd(t)?(i(),l("button",{key:2,type:"button",class:"item-action",onClick:o=>a.onTake(t)}," Take ",8,L)):r("",!0),m("button",{type:"button",class:"item-action",onClick:o=>e.emit("sell",t,n.inv),onMouseenterCapture:h(o=>e.itemOver(o,t),["stop"])}," Sell ",40,R),t.count>1?(i(),l("button",{key:3,type:"button",class:"item-action",onClick:o=>e.emit("sell",t,n.inv,t.count),onMouseenterCapture:h(o=>e.itemOver(o,t),["stop"])}," Sell All ",40,W)):r("",!0)],64))])],2))),128))],512),a.playerFull?(i(),l("div",j,"Inventory Full")):r("",!0)])}const H=b(U,[["render",G],["__scopeId","data-v-da7bb649"]]);export{H as default};
